# Шаг 1: Выбираем базовый образ. Мы возьмем официальный образ Python 3.11.
# Он уже содержит Python и менеджер пакетов pip.
FROM python:3.11-slim

# Шаг 2: Устанавливаем рабочую директорию внутри контейнера.
# Все последующие команды будут выполняться из этой папки.
WORKDIR /app

# Шаг 3: Копируем файл с зависимостями в контейнер.
# Мы копируем только его, а не весь код, чтобы использовать кэширование Docker.
# Если этот файл не изменится, Docker не будет переустанавливать зависимости при каждой сборке.
COPY requirements.txt .

# Шаг 4: Устанавливаем зависимости.
RUN pip install --no-cache-dir -r requirements.txt

# Шаг 5: Копируем все остальные файлы нашего проекта в рабочую директорию контейнера.
COPY . .

# Шаг 6: Указываем команду, которая будет запущена при старте контейнера.
# Мы запускаем uvicorn, чтобы он "слушал" запросы на всех сетевых интерфейсах (0.0.0.0)
# внутри контейнера на порту 8000.
CMD ["uvicorn", "web_app:app", "--host", "0.0.0.0", "--port", "8000"]